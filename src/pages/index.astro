---
import Layout from '../components/Layout.astro';
import { getCollection } from 'astro:content';
import RecipeCard from '../components/RecipeCard.astro';

const recipes = await getCollection('recipes');
const episodes = await getCollection('episodes');

// Get latest recipes and episodes
const latestRecipes = recipes
  .sort((a, b) => b.data.publishDate.getTime() - a.data.publishDate.getTime())
  .slice(0, 6);

const latestEpisodes = episodes
  .sort((a, b) => b.data.publishDate.getTime() - a.data.publishDate.getTime())
  .slice(0, 3);
---

<Layout title="Home">
  <!-- Hero Section -->
  <section class="bg-gradient-to-r from-amber-50 to-orange-50 py-20">
    <div class="max-w-7xl mx-auto px-4 text-center">
      <h1 class="text-5xl font-bold text-gray-900 mb-6">
        Kaz Mielony
      </h1>
      <p class="text-xl text-gray-600 mb-8 max-w-3xl mx-auto">
        Exploring history through the meals of iconic and controversial figures. 
        Join me on a culinary journey through time, one recipe at a time.
      </p>
      <div class="flex justify-center space-x-4">
        <a 
          href="/recipes" 
          class="bg-amber-600 text-white px-8 py-3 rounded-lg font-semibold hover:bg-amber-700 transition-colors"
        >
          Browse Recipes
        </a>
        <a 
          href="/episodes" 
          class="border border-amber-600 text-amber-600 px-8 py-3 rounded-lg font-semibold hover:bg-amber-50 transition-colors"
        >
          Watch Episodes
        </a>
      </div>
    </div>
  </section>

  <!-- Latest Recipes -->
  <section class="py-16">
    <div class="max-w-7xl mx-auto px-4">
      <div class="flex justify-between items-center mb-8">
        <h2 class="text-3xl font-bold text-gray-900">Latest Recipes</h2>
        <a href="/recipes" class="text-amber-600 hover:text-amber-700 font-semibold">
          View All →
        </a>
      </div>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        {latestRecipes.map((recipe) => (
          <RecipeCard recipe={recipe} />
        ))}
      </div>
    </div>
  </section>

  <!-- Featured Episodes -->
  <section class="bg-gray-100 py-16">
    <div class="max-w-7xl mx-auto px-4">
      <div class="flex justify-between items-center mb-8">
        <h2 class="text-3xl font-bold text-gray-900">Recent Episodes</h2>
        <a href="/episodes" class="text-amber-600 hover:text-amber-700 font-semibold">
          View All →
        </a>
      </div>
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        {latestEpisodes.map((episode) => (
          <article class="bg-white rounded-lg shadow-md overflow-hidden">
            <div class="aspect-video bg-gray-200">
              <iframe
                class="w-full h-full"
                src={`https://www.youtube.com/embed/${episode.data.youtubeId}`}
                title={episode.data.title}
                frameborder="0"
                allowfullscreen>
              </iframe>
            </div>
            <div class="p-6">
              <h3 class="text-xl font-bold mb-2">
                <a href={`/episodes/${episode.slug}`} class="text-gray-900 hover:text-amber-600">
                  {episode.data.title}
                </a>
              </h3>
              <p class="text-gray-600 mb-3">Episode {episode.data.episodeNumber}</p>
              <p class="text-gray-700 text-sm">{episode.data.description}</p>
            </div>
          </article>
        ))}
      </div>
    </div>
  </section>

  <!-- About Section -->
  <section class="py-16">
    <div class="max-w-4xl mx-auto px-4 text-center">
      <h2 class="text-3xl font-bold text-gray-900 mb-6">About the Channel</h2>
      <p class="text-lg text-gray-600 mb-8">
        History isn't just about dates and battles—it's about the people who lived it. 
        Through their favorite meals, we can understand their cultures, their times, 
        and sometimes their controversies. Each episode explores not just how to cook 
        these historical dishes, but why they mattered to the people who ate them.
      </p>
      <a 
        href="/about" 
        class="inline-block bg-amber-600 text-white px-8 py-3 rounded-lg font-semibold hover:bg-amber-700 transition-colors"
      >
        Learn More
      </a>
    </div>
  </section>
</Layout>
