---
import Layout from '../components/Layout.astro';
import { getCollection } from 'astro:content';
import RecipeCard from '../components/RecipeCard.astro';

const recipes = await getCollection('recipes');
const episodes = await getCollection('episodes');

// Get latest recipes and episodes
const latestRecipes = recipes
  .sort((a, b) => b.data.publishDate.getTime() - a.data.publishDate.getTime())
  .slice(0, 6);

const latestEpisodes = episodes
  .sort((a, b) => b.data.publishDate.getTime() - a.data.publishDate.getTime())
  .slice(0, 3);
---

<Layout title="Home">
  <!-- Hero Section -->
  <section class="bg-gradient-to-br from-background via-background to-background/90 py-24">
    <div class="max-w-7xl mx-auto px-4 text-center">
      <h1 class="text-7xl font-bold text-primary mb-6">
        KAZ MIELONY
      </h1>
      <p class="text-xl text-text-light/80 mb-10 max-w-3xl mx-auto">
        Exploring history through the meals of iconic and controversial figures. 
        Join me on a culinary journey through time, one recipe at a time.
      </p>
      <div class="flex justify-center space-x-4">
        <a 
          href="/recipes" 
          class="bg-primary text-background px-8 py-4 rounded-lg font-semibold hover:bg-accent transition-colors shadow-lg"
        >
          Browse Recipes
        </a>
        <a 
          href="/episodes" 
          class="border-2 border-primary text-primary px-8 py-4 rounded-lg font-semibold hover:bg-primary hover:text-background transition-colors"
        >
          Watch Episodes
        </a>
      </div>
    </div>
  </section>

  <!-- Latest Recipes -->
  <section class="bg-white py-20">
    <div class="max-w-7xl mx-auto px-4">
      <div class="flex justify-between items-center mb-12">
        <h2 class="text-4xl font-bold text-gray-900">Latest Recipes</h2>
        <a href="/recipes" class="text-primary hover:text-accent font-semibold text-lg">
          View All →
        </a>
      </div>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        {latestRecipes.map((recipe) => (
          <RecipeCard recipe={recipe} />
        ))}
      </div>
    </div>
  </section>

  <!-- Featured Episodes -->
  <section class="bg-gray-50 py-20">
    <div class="max-w-7xl mx-auto px-4">
      <div class="flex justify-between items-center mb-12">
        <h2 class="text-4xl font-bold text-gray-900">Recent Episodes</h2>
        <a href="/episodes" class="text-primary hover:text-accent font-semibold text-lg">
          View All →
        </a>
      </div>
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        {latestEpisodes.map((episode) => (
          <article class="bg-white rounded-xl shadow-lg overflow-hidden border border-gray-200 hover:shadow-xl transition-shadow">
            <div class="aspect-video bg-gray-100">
              <iframe
                class="w-full h-full"
                src={`https://www.youtube.com/embed/${episode.data.youtubeId}`}
                title={episode.data.title}
                frameborder="0"
                allowfullscreen>
              </iframe>
            </div>
            <div class="p-6">
              <h3 class="text-xl font-bold mb-2">
                <a href={`/episodes/${episode.slug}`} class="text-gray-900 hover:text-primary transition-colors">
                  {episode.data.title}
                </a>
              </h3>
              <p class="text-primary font-medium mb-3">Episode {episode.data.episodeNumber}</p>
              <p class="text-gray-600 text-sm leading-relaxed">{episode.data.description}</p>
            </div>
          </article>
        ))}
      </div>
    </div>
  </section>

  <!-- About Section -->
  <section class="bg-background py-20">
    <div class="max-w-4xl mx-auto px-4 text-center">
      <h2 class="text-4xl font-bold text-primary mb-8">About the Channel</h2>
      <p class="text-xl text-text-light/80 mb-10 leading-relaxed">
        History isn't just about dates and battles—it's about the people who lived it. 
        Through their favorite meals, we can understand their cultures, their times, 
        and sometimes their controversies. Each episode explores not just how to cook 
        these historical dishes, but why they mattered to the people who ate them.
      </p>
      <a 
        href="/about" 
        class="inline-block bg-primary text-background px-10 py-4 rounded-lg font-semibold hover:bg-accent transition-colors shadow-lg"
      >
        Learn More
      </a>
    </div>
  </section>
</Layout>
